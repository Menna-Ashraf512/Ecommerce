import{a as D,b as N}from"./chunk-IQSQYAMH.js";import{a as I,b as c,c as q,d as V,h as F,i as G,j as M,l as A,n as Z}from"./chunk-PH4MJFUA.js";import{i as L}from"./chunk-CDTZA3VN.js";import"./chunk-3KDYLMZQ.js";import{Ab as u,Db as w,Fb as T,Gb as p,Ob as a,Qb as E,Ra as o,Ub as _,Vb as C,Wb as v,Z as x,ab as P,ea as k,fa as y,ga as h,gb as s,ha as b,qb as S,ub as m,yb as t,zb as i}from"./chunk-VHZDE6SP.js";function U(e,r){e&1&&(t(0,"li"),a(1,"Name Should be more than or equal 3 chars"),i())}function B(e,r){e&1&&(t(0,"li"),a(1,"Name Should be less than or equal 20 chars"),i())}function z(e,r){e&1&&(t(0,"li"),a(1,"Name is required"),i())}function O(e,r){if(e&1&&(t(0,"div",6),h(),t(1,"svg",14),u(2,"path",15),i(),b(),t(3,"span",16),a(4,"Danger"),i(),t(5,"div")(6,"ul",17),s(7,U,2,0,"li")(8,B,2,0,"li")(9,z,2,0,"li"),i()()()),e&2){p();let n=v(5);o(7),m(n!=null&&n.getError("minlength")?7:-1),o(),m(n!=null&&n.getError("maxlength")?8:-1),o(),m(n!=null&&n.getError("required")?9:-1)}}function R(e,r){e&1&&(t(0,"li"),a(1,"Enter Valid Email"),i())}function j(e,r){e&1&&(t(0,"li"),a(1,"Email is required"),i())}function $(e,r){if(e&1&&(t(0,"div",6),h(),t(1,"svg",14),u(2,"path",15),i(),b(),t(3,"span",16),a(4,"Danger"),i(),t(5,"div")(6,"ul",17),s(7,R,2,0,"li")(8,j,2,0,"li"),i()()()),e&2){p();let n=v(11);o(7),m(n!=null&&n.getError("pattern")?7:-1),o(),m(n!=null&&n.getError("required")?8:-1)}}function J(e,r){e&1&&(t(0,"li"),a(1,"accept only egypt phone numbers"),i())}function K(e,r){e&1&&(t(0,"li"),a(1,"phone is required"),i())}function Q(e,r){if(e&1&&(t(0,"div",6),h(),t(1,"svg",14),u(2,"path",15),i(),b(),t(3,"span",16),a(4,"Danger"),i(),t(5,"div")(6,"ul",17),s(7,J,2,0,"li")(8,K,2,0,"li"),i()()()),e&2){p();let n=v(17);o(7),m(n!=null&&n.getError("pattern")?7:-1),o(),m(n!=null&&n.getError("required")?8:-1)}}function W(e,r){e&1&&(t(0,"span"),u(1,"i",18),i())}function X(e,r){if(e&1&&(t(0,"p",12),a(1),i()),e&2){let n=p();o(),E(" ",n.messageError," ")}}function Y(e,r){if(e&1&&(t(0,"p",13),a(1),i()),e&2){let n=p();o(),E(" ",n.messageSuccess," ")}}var H=class e{authService=x(N);router=x(L);_formBuilder=x(A);isLoading=!1;messageError="";messageSuccess="";userId=null;userData=this._formBuilder.group({name:[null,[c.required,c.minLength(3),c.maxLength(30)]],email:[null,[c.required,c.pattern(/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/)]],phone:[null,[c.required,c.pattern(/^01[0125][0-9]{8}$/)]]});ngOnInit(){this.loadUserProfile()}loadUserProfile(){let r=localStorage.getItem("userToken");if(r){let n=D(r);this.userId=n.id,this.userId&&this.authService.getUser(this.userId).subscribe({next:l=>{let d=l.data;this.userData.patchValue({name:d.name,email:d.email,phone:d.phone}),this.authService.userProfile.next(d),console.log("User Profile:",d)},error:l=>{this.messageError="Failed to load user profile",console.error(l)}})}}updateProfile(){this.userData.valid&&this.userId?(this.isLoading=!0,this.authService.updateUser(this.userData.value).subscribe({next:r=>{console.log(r),this.isLoading=!1},error:r=>{this.messageError=r.error.message||"Failed to update profile",this.isLoading=!1}})):this.userData.markAllAsTouched()}static \u0275fac=function(n){return new(n||e)};static \u0275cmp=P({type:e,selectors:[["app-profile"]],decls:27,vars:10,consts:[[1,"w-1/2","mx-auto","bg-gray-50","p-4","rounded","border","shadow","my-10"],[1,"text-3xl","font-light","text-center","text-main","mb-4"],[3,"ngSubmit","formGroup"],[1,"mb-2"],["for","name",1,"block","mb-2","text-sm","font-medium","text-gray-900","dark:text-black"],["formControlName","name","type","text","id","name",1,"bg-white","border","border-gray-300","text-black","text-sm","rounded-lg","focus:ring-main","focus:border-main","block","w-full","p-2.5","dark:bg-gray-700","dark:border-gray-600","dark:placeholder-gray-400","dark:text-black","dark:focus:ring-main","dark:focus:border-main"],["role","alert",1,"flex","p-4","mb-4","text-sm","text-red-800","rounded-lg","bg-red-50","dark:bg-gray-800","dark:text-red-400"],["for","email",1,"block","mb-2","text-sm","font-medium","text-gray-900","dark:text-black"],["formControlName","email","type","email","id","email",1,"bg-white","border","border-gray-300","text-black","text-sm","rounded-lg","focus:ring-main","focus:border-main","block","w-full","p-2.5","dark:bg-gray-700","dark:border-gray-600","dark:placeholder-gray-400","dark:text-black","dark:focus:ring-main","dark:focus:border-main"],["for","phone",1,"block","mb-2","text-sm","font-medium","text-gray-900","dark:text-black"],["formControlName","phone","type","tel","id","phone",1,"bg-white","border","border-gray-300","text-black","text-sm","rounded-lg","focus:ring-main","focus:border-main","block","w-full","p-2.5","dark:bg-gray-700","dark:border-gray-600","dark:placeholder-gray-400","dark:text-black","dark:focus:ring-main","dark:focus:border-main"],["type","submit",1,"btn-main","px-4","py-2","mt-5",3,"disabled"],[1,"bg-red-400","text-white","py-4","px-2","border","text-center"],[1,"bg-green-600","text-white","py-4","px-2","border","text-center"],["aria-hidden","true","xmlns","http://www.w3.org/2000/svg","fill","currentColor","viewBox","0 0 20 20",1,"shrink-0","inline","w-4","h-4","me-3","mt-[2px]"],["d","M10 .5a9.5 9.5 0 1 0 9.5 9.5A9.51 9.51 0 0 0 10 .5ZM9.5 4a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3ZM12 15H8a1 1 0 0 1 0-2h1v-3H8a1 1 0 0 1 0-2h2a1 1 0 0 1 1 1v4h1a1 1 0 0 1 0 2Z"],[1,"sr-only"],[1,"mt-1.5","list-disc","list-inside"],[1,"fa","fa-spin","fa-spinner"]],template:function(n,l){if(n&1){let d=w();t(0,"section",0)(1,"h1",1),a(2,"Register Now"),i(),t(3,"form",2),T("ngSubmit",function(){return k(d),y(l.updateProfile())}),t(4,"div",3),_(5),t(6,"label",4),a(7,"Name"),i(),u(8,"input",5),s(9,O,10,3,"div",6),i(),t(10,"div",3),_(11),t(12,"label",7),a(13,"Email"),i(),u(14,"input",8),s(15,$,9,2,"div",6),i(),t(16,"div",3),_(17),t(18,"label",9),a(19,"Phone"),i(),u(20,"input",10),s(21,Q,9,2,"div",6),i(),t(22,"button",11),a(23," update "),s(24,W,2,0,"span"),i(),s(25,X,2,1,"p",12)(26,Y,2,1,"p",13),i()()}if(n&2){o(3),S("formGroup",l.userData),o(2);let d=C(l.userData.get("name"));o(4),m(d!=null&&d.errors&&(d!=null&&d.touched)?9:-1),o(2);let f=C(l.userData.get("email"));o(4),m(f!=null&&f.errors&&(f!=null&&f.touched)?15:-1),o(2);let g=C(l.userData.get("phone"));o(4),m(g!=null&&g.errors&&(g!=null&&g.touched)?21:-1),o(),S("disabled",l.userData.invalid||l.isLoading),o(2),m(l.isLoading?24:-1),o(),m(l.messageError&&!l.messageSuccess?25:l.messageSuccess?26:-1)}},dependencies:[Z,F,I,q,V,G,M],encapsulation:2})};export{H as ProfileComponent};
