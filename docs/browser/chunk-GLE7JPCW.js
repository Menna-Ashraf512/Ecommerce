import{a as E}from"./chunk-E3Z6VSMY.js";import{a as P}from"./chunk-SAR2OAUH.js";import{a as k}from"./chunk-Y53QA6CX.js";import{a as L}from"./chunk-TM6OZZCA.js";import{i as I}from"./chunk-CDTZA3VN.js";import{Ab as n,Ec as y,Fb as l,Gb as b,Oa as f,Ob as d,Pb as w,Qb as m,Ra as s,Z as c,Zb as C,ab as g,bc as S,dc as x,gb as p,qb as v,tb as _,ub as u,yb as o,zb as a}from"./chunk-VHZDE6SP.js";var T=r=>({"text-red-700":r});function W(r,i){r&1&&n(0,"i",7)}function F(r,i){if(r&1&&n(0,"i",15),r&2){let e=b();_(C(2,T,e.wishListIds.includes(e.product._id)))}}function M(r,i){r&1&&n(0,"i",7)}function j(r,i){r&1&&n(0,"i",9)}var D=class r{product;drawer;userDataSubscription;_cartService=c(L);_wishListService=c(P);_toastrService=c(E);_router=c(I);isLoadingCart=!1;isLoadingWish=!1;wishListIds=[];ngOnInit(){this._wishListService.getLoggedUserWishList().subscribe(e=>{e&&e.data&&Array.isArray(e.data)&&(this.wishListIds=e.data.map(t=>t._id))});let i=document.getElementById("drawer-disabled-backdrop");this.drawer=new k(i,{backdrop:!1})}addCartItem(i){this.isLoadingCart=!0,this._cartService.addProductToCart(i).subscribe({next:e=>{this._toastrService.success(e.message,this.product.category.name),this._cartService.cartNumber.set(e.numOfCartItems),this.drawer.show()},error:e=>{this._toastrService.error(e.error.message,"MegaCart"),this.isLoadingCart=!1},complete:()=>this.isLoadingCart=!1})}toggleWishItem(i){this.isLoadingWish=!0,this.wishListIds.includes(i)?this._wishListService.removeSpecificFromWishList(i).subscribe({next:e=>{this._toastrService.info(e.message,this.product.category.name),this._wishListService.wishNumber.set(e.data.length),this.wishListIds=this.wishListIds.filter(t=>t!==i)},error:()=>this._toastrService.error("Failed to remove from wishlist"),complete:()=>this.isLoadingWish=!1}):this._wishListService.addProductToWishList(i).subscribe({next:e=>{this._toastrService.success(e.message,this.product.category.name),this._wishListService.wishNumber.set(e.data.length),this.wishListIds=[i]},error:()=>this._toastrService.error("Failed to add to wishlist"),complete:()=>this.isLoadingWish=!1})}viewDetails(){this._router.navigate(["/details",this.product._id])}ngOnDestroy(){this.userDataSubscription&&this.userDataSubscription.unsubscribe()}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=g({type:r,selectors:[["app-product-item"]],inputs:{product:"product"},decls:25,vars:10,consts:[[1,"flex","flex-col","w-full","mx-auto","max-w-sm","rounded-xl","shadow-lg","border","dark:bg-gray-800","group"],[1,"relative","overflow-hidden"],["alt","product image",1,"rounded-t-lg","w-52","h-52","mx-auto","object-cover","group-hover:scale-110","duration-200",3,"src"],[1,"overlay__Product","w-full","h-full","bg-rgba","opacity-0","absolute","top-0","flex","justify-end","pr-2","group-hover:opacity-100","transition-opacity","duration-200"],[1,"mt-3"],[1,"bg-main","w-10","h-10","mb-2","rounded-full","flex","justify-center","items-center","hover:bg-black","hover:text-white","transition-all","duration-300",3,"click"],[1,"fa-regular","fa-eye"],[1,"fa","fa-spin","fa-spinner"],[1,"fa","fa-heart",3,"class"],[1,"fa-solid","fa-cart-plus"],[1,"bg-[#EEF0F2]","p-4"],[1,"text-gray-600","text-sm"],[1,"mb-4","text-xl"],[1,"flex","justify-between","mb-3"],[1,"fa","fa-star","text-rating"],[1,"fa","fa-heart"]],template:function(e,t){e&1&&(o(0,"div",0)(1,"div",1),n(2,"img",2),o(3,"div",3)(4,"ul",4)(5,"li",5),l("click",function(){return t.viewDetails()}),n(6,"i",6),a(),o(7,"li",5),l("click",function(){return t.toggleWishItem(t.product.id)}),p(8,W,1,0,"i",7)(9,F,1,4,"i",8),a(),o(10,"li",5),l("click",function(){return t.addCartItem(t.product.id)}),p(11,M,1,0,"i",7)(12,j,1,0,"i",9),a()()()(),o(13,"div",10)(14,"p",11),d(15),a(),o(16,"h2",12),d(17),a(),o(18,"div",13)(19,"p"),d(20),S(21,"currency"),a(),o(22,"p"),n(23,"i",14),d(24),a()()()()),e&2&&(s(2),v("src",t.product.imageCover,f),s(6),u(t.isLoadingWish?8:9),s(3),u(t.isLoadingCart?11:12),s(4),w(t.product.category.name),s(2),m(" ",t.product.title.split(" ",2).join(" ")," "),s(3),m(" ",x(21,7,t.product.price,"GBP")," "),s(4),m(" ",t.product.ratingsAverage," "))},dependencies:[y],styles:[".product[_ngcontent-%COMP%]{border:1px solid #FFCE00;box-shadow:inset #f9f0c7 0 1px 20px 7px;padding:1.5rem;border-radius:20px;transition:all .5s ease-in-out}.product[_ngcontent-%COMP%]:hover{transform:scale(1.05)}.text-red[_ngcontent-%COMP%]{color:red}"]})};export{D as a};
